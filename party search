

proc sql ; 
create table WORK.Teresi_Run  as select * from connection to oracle( 

SELECT DISTINCT 
CL.CLAIMNUMBER as Claim_Number
,to_char(CL.LOSSDATE, 'MM-DD-YYYY') as Loss_Date
,to_char(CL.LOSSDATE, 'HH24:MI') as Loss_Time
,to_char(CL.REPORTEDDATE, 'MM-DD-YYYY') as Reported_Date
,ACCST2.TYPECODE AS LOSS_STATE
,RSKST.TYPECODE AS RISK_STATE
,policeonscene.description as Police_On_Scene
,CL.FAULT
,ACCTYPE.NAME AS LOSS_TYPE
,CL.DESCRIPTION
,ACCST1.ADDRESSLINE1 AS LOSS_ADDRESS1
,ACCST1.CITY AS LOSS_CITY
,ACCST1.COUNTY AS LOSS_COUNTY
,siustatus.description as SIU_STATUS
,VEH.YEAR 
,VEH.MAKE 
,VEH.MODEL
,VEH.VIN
,insdind.Description as Insd_Indicator
,t2.PERSONFIRSTNAMEDENORM as IP_First_Name
,t2.PERSONLASTNAMEDENORM as IP_Last_Name
,t3.CELLPHONE
,t3.HOMEPHONE
,t3.WORKPHONE
,role1.Description as Role
,exp2.typecode as Coverage

FROM
CLAIMCENTER.CC_CLAIM CL
LEFT JOIN CLAIMCENTER.CC_INCIDENT  INCD
	ON INCD.CLAIMID = CL.ID
left join claimcenter.CCTL_YESNO insdind
	on insdind.id = incd.ext_InsuredIsOwnerInd
	/*insured indicator*/
LEFT JOIN CLAIMCENTER.ACCIDENTTYPE  ACCTYPE
    ON CL.ACCIDENTTYPE = ACCTYPE.ID
LEFT JOIN CLAIMCENTER.cc_claimcontactrole role
	ON INCD.ID = role.INCIDENTID
left join CLAIMCENTER.CCTL_CONTACTROLE role1
	on role.role = role1.ID
LEFT OUTER JOIN CLAIMCENTER.CC_CLAIMCONTACT t2
	ON role.CLAIMCONTACTID = t2.ID
LEFT JOIN CLAIMCENTER.CC_CONTACT t3
	ON t2.CONTACTID = t3.ID 
	LEFT JOIN CLAIMCENTER.CC_ADDRESS ACCST1 
	ON CL.LOSSLOCATIONID = ACCST1.ID
		LEFT JOIN CLAIMCENTER.CCTL_STATE ACCST2 
		ON ACCST1.STATE = ACCST2.ID
LEFT JOIN CLAIMCENTER.CC_POLICY  POL 
ON CL.POLICYID = POL.ID 
	LEFT JOIN CLAIMCENTER.CCTL_STATE  RSKST
	ON POL.EXT_RISKSTATE = RSKST.ID
	LEFT JOIN CLAIMCENTER.CC_COVERAGE  COV 
	ON POL.ID = COV.POLICYID 
		LEFT JOIN CLAIMCENTER.CC_RISKUNIT  RSKUN
		ON COV.RISKUNITID = RSKUN.ID
	LEFT JOIN CLAIMCENTER.CC_VEHICLE  VEH
	ON INCD.VEHICLEID = VEH.ID
		LEFT JOIN CLAIMCENTER.CC_RISKUNIT  RSKUN2
		ON VEH.ID = RSKUN2.VEHICLEID

LEFT JOIN CLAIMCENTER.CC_EXPOSURE  EXP 
ON CL.ID = EXP.CLAIMID AND t3.ID = EXP.CLAIMANTDENORMID
	LEFT JOIN CLAIMCENTER.CCTL_COVERAGETYPE  PC
	ON EXP.PRIMARYCOVERAGE = PC.ID

LEFT JOIN CLAIMCENTER.CCX_COVERAGECONDITION  CC1
ON CL.ID = CC1.CLAIMID 
	LEFT JOIN CLAIMCENTER.CCTL_EXT_COVERAGECONDCODE  CC2
	ON CC1.EXT_COVERAGECONDCODE = CC2.ID

	left join claimcenter.cctl_yesno policeonscene
		on policeonscene.id = cl.ext_PoliceOnScene
inner join CLAIMCENTER.cctl_coveragetype  exp2
	on exp.primarycoverage = exp2.id
left join claimcenter.ccx_sicminformation sicm
	on sicm.claimid = cl.id
	left join claimcenter.cctl_siustatus siustatus
		on siustatus.id = sicm.Ext_ReferralStatusType



WHERE 

/*
parameters here
*/

);
disconnect from oracle;
quit;
